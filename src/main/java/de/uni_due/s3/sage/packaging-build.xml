<?xml version="1.0" encoding="UTF-8"?>
<project name="Jack 2.0 Server" default="application packaging essen">
	<target name="application packaging essen">
		<property name="layoutFolder" value="essen" />
		<property name="targetFolder" value="essen" />
	
		<antcall target="application packaging" />
	</target>
	
	<target name="application packaging entrance to expertise">
		<property name="layoutFolder" value="etexpertise" />
		<property name="targetFolder" value="etexpertise" />
		
		<antcall target="application packaging" />
	</target>

	<target name="application packaging paluno">
		<property name="layoutFolder" value="paluno" />
		<property name="targetFolder" value="paluno" />
		
		<antcall target="application packaging" />
	</target>
	
	<target name="application packaging mathevorkurs">
			<property name="layoutFolder" value="mathevorkurs" />
			<property name="targetFolder" value="mathevorkurs" />
			
			<antcall target="application packaging" />
	</target>
	
	<target name="application packaging leicester">
					<property name="layoutFolder" value="leicester" />
					<property name="targetFolder" value="leicester" />
					
					<antcall target="application packaging" />
	</target>
	
	<target name="application packaging newLayout">
				<property name="layoutFolder" value="newLayout" />
				<property name="targetFolder" value="newLayout" />
				
				<antcall target="application packaging" />
		</target>
	
	<target name="application packaging demo">
		<property name="layoutFolder" value="demo" />
		<property name="targetFolder" value="demo" />
	
		<antcall target="application packaging" />
	</target>
	
	<target name="application packaging duisburg">
		<property name="layoutFolder" value="duisburg" />
		<property name="targetFolder" value="duisburg" />
		
		<antcall target="application packaging" />
	</target>

	<target name="application packaging javacamp">
		<property name="layoutFolder" value="javacamp" />
		<property name="targetFolder" value="javacamp" />
		
		<antcall target="application packaging" />
	</target>

	<target name="application packaging rhein-waal">
		<property name="layoutFolder" value="rhein-waal" />
		<property name="targetFolder" value="rhein-waal" />
		
		<antcall target="application packaging" />
	</target>
	
	<target name="application packaging mikro_makro">
		<property name="layoutFolder" value="mikro_makro" />
		<property name="targetFolder" value="mikro_makro" />
		
		<antcall target="application packaging" />
	</target>
	
	<target name="application packaging marburg">
			<property name="layoutFolder" value="marburg" />
			<property name="targetFolder" value="marburg" />
			
			<antcall target="application packaging" />
	</target>
	
	<target name="application packaging jackmachtschule">
				<property name="layoutFolder" value="jackmachtschule" />
				<property name="targetFolder" value="jackmachtschule" />
				
				<antcall target="application packaging" />
	</target>
	
	<target name="application packaging fasmed" >
		<property name="layoutFolder" value="fasmed" />
		<property name="targetFolder" value="fasmed" />
		
		<antcall target="application packaging" />
	</target>

	<target name="application packaging ios" >
		<property name="layoutFolder" value="ios" />
		<property name="targetFolder" value="ios" />
		
		<antcall target="application packaging" />
	</target>

	<target name="application packaging">
		<delete dir="output/${targetFolder}" />
		<mkdir dir="output/${targetFolder}" />
		
		<antcall target="jar" />
		<antcall target="war" />
		<antcall target="ear" />
		
		<move file="output/jack2.jar" todir="output/${targetFolder}" />
		<move file="output/jack2.war" todir="output/${targetFolder}" />
		<copy file="output/jack2.ear" todir="${jBossHomeJack2}/server/default/deploy/" overwrite="true" />
		<move file="output/jack2.ear" todir="output/${targetFolder}" />
	</target>
	
	<target name="jar" description="jack2.jar">
		<jar destfile="output/jack2.jar">
			<zipfileset dir="resources" prefix="META-INF">
				<include name="persistence.xml" />
				<include name="mime.types" />
			</zipfileset>
			<zipfileset dir="../de.uni_due.s3.jack2.server.webfrontend/resources">
				<include name="MessageResources_de.properties"/>
				<include name="MessageResources_en.properties"/>
			</zipfileset>
			<zipfileset dir="bin" />
			<zipfileset dir="lib/package" />
			
			<zipfileset dir="../de.uni_due.s3.jack2.server.webfrontend/bin" />
			<zipfileset dir="../de.uni_due.s3.jack2.server.webfrontend/lib" />
			<zipfileset dir="../de.uni_due.s3.jack2.server.common/bin" />
			<zipfileset dir="../de.uni_due.s3.jack2.server.common" prefix="de/uni_due/s3/jack2/server/common">
				<include name="exerciseDefinition.xsd" />
				<include name="stageData.xsd" />
			</zipfileset>
			<zipfileset dir="../de.uni_due.s3.jack2.server.webfrontend/web/all/images" prefix="web/images" />
		</jar>
	</target>
	<target name="war" description="jack2.war">
		<jar destfile="output/jack2.war" duplicate="preserve">
			<zipfileset dir="../de.uni_due.s3.jack2.server.webfrontend/resources" prefix="WEB-INF">
				<include name="faces-config.xml" />
				<include name="tomahawk.taglib.xml" />
				<include name="web.xml" />
			</zipfileset>
			<zipfileset dir="../de.uni_due.s3.jack2.server.webfrontend/web/${layoutFolder}"  />
			<zipfileset dir="../de.uni_due.s3.jack2.server.webfrontend/web/all" >
				<exclude name="/mathjax/**" />
			</zipfileset>
		</jar>
	</target>
	<target name="ear" description="jack2.ear">
		<jar destfile="output/jack2.ear">
			<zipfileset dir="output">
				<include name="jack2.jar" />
			</zipfileset>
			<zipfileset dir="resources" prefix="META-INF">
				<include name="application.xml" />
			</zipfileset>
			<zipfileset dir="output">
				<include name="jack2.war" />
			</zipfileset>
		</jar>
	</target>
	
	<target name="resources packaging" description="jack2-resources.war">
		<delete file="output/jack2-resources.war" />
		
		<jar destfile="output/jack2-resources.war" duplicate="preserve">
			<zipfileset dir="../de.uni_due.s3.jack2.server.webfrontend/web/resources" />
		</jar>

		<copy file="output/jack2-resources.war" todir="${jBossHomeJack2}/server/default/deploy/" overwrite="true" />
	</target>
</project>
